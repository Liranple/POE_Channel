$images = @(
    @{ Url = "https://web.poecdn.com/image/divination-card/HouseOfMirrors.png"; Path = "public/images/cards/HouseOfMirrors.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheApothecary.png"; Path = "public/images/cards/TheApothecary.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/UnrequitedLove.png"; Path = "public/images/cards/UnrequitedLove.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/Damnation.png"; Path = "public/images/cards/Damnation.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/FireOfUnknownOrigin.png"; Path = "public/images/cards/FireOfUnknownOrigin.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/ThePriceOfDevotion.png"; Path = "public/images/cards/ThePriceOfDevotion.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/FathersLove.png"; Path = "public/images/cards/FathersLove.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/History.png"; Path = "public/images/cards/History.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheInsaneCat.png"; Path = "public/images/cards/TheInsaneCat.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheDoctor.png"; Path = "public/images/cards/TheDoctor.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheDemon.png"; Path = "public/images/cards/TheDemon.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheImmortal.png"; Path = "public/images/cards/TheImmortal.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheFiend.png"; Path = "public/images/cards/TheFiend.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/BrotherGift.png"; Path = "public/images/cards/BrotherGift.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheProgenyofLunaris.png"; Path = "public/images/cards/TheProgenyofLunaris.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/DivineJustice.png"; Path = "public/images/cards/DivineJustice.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/ISeeBrothers.png"; Path = "public/images/cards/ISeeBrothers.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheEndlessDarkness.png"; Path = "public/images/cards/TheEndlessDarkness.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheCheater.png"; Path = "public/images/cards/TheCheater.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/Outfoxed.png"; Path = "public/images/cards/Outfoxed.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/SevenYearsBadLuck.png"; Path = "public/images/cards/SevenYearsBadLuck.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/LoveThroughIce.png"; Path = "public/images/cards/LoveThroughIce.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheRabbitsFoot.png"; Path = "public/images/cards/TheRabbitsFoot.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheNurse.png"; Path = "public/images/cards/TheNurse.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/WealthAndPower.png"; Path = "public/images/cards/WealthAndPower.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/ChokingGuilt.png"; Path = "public/images/cards/ChokingGuilt.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/LastStand.png"; Path = "public/images/cards/LastStand.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/LonelyWarrior.png"; Path = "public/images/cards/LonelyWarrior.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/OneLastScore.png"; Path = "public/images/cards/OneLastScore.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheSephirot.png"; Path = "public/images/cards/TheSephirot.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/TheLake.png"; Path = "public/images/cards/TheLake.png" },
    @{ Url = "https://web.poecdn.com/image/divination-card/LuminousTrove.png"; Path = "public/images/cards/LuminousTrove.png" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Currency/CurrencyDuplicate.webp"; Path = "public/images/items/CurrencyDuplicate.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Belts/InjectorBelt.webp"; Path = "public/images/items/InjectorBelt.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Currency/MirrorShard.webp"; Path = "public/images/items/MirrorShard.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Relics/RelicUnique4x1.webp"; Path = "public/images/items/RelicUnique4x1.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Rings/UberEaterofWorlds.webp"; Path = "public/images/items/UberEaterofWorlds.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/SublimeVision.webp"; Path = "public/images/items/SublimeVision.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Currency/HinekorasLock.webp"; Path = "public/images/items/HinekorasLock.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Belts/Headhunter.webp"; Path = "public/images/items/Headhunter.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Currency/CurrencyModValues.webp"; Path = "public/images/items/CurrencyModValues.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Flasks/ShapersFlask.webp"; Path = "public/images/items/ShapersFlask.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Currency/FracturingOrbCombined.webp"; Path = "public/images/items/FracturingOrbCombined.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Weapons/TwoHandWeapons/TwoHandSwords/Starforge.webp"; Path = "public/images/items/Starforge.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/RedGrandSpectrum.webp"; Path = "public/images/items/RedGrandSpectrum.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/BlueGrandSpectrum.webp"; Path = "public/images/items/BlueGrandSpectrum.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GreenGrandSpectrum.webp"; Path = "public/images/items/GreenGrandSpectrum.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum3_Red.webp"; Path = "public/images/items/GrandSpectrum3_Red.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum2_blue.webp"; Path = "public/images/items/GrandSpectrum2_blue.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum2_Green.webp"; Path = "public/images/items/GrandSpectrum2_Green.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum3_Green.webp"; Path = "public/images/items/GrandSpectrum3_Green.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum3_Blue.webp"; Path = "public/images/items/GrandSpectrum3_Blue.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GrandSpectrum2_red.webp"; Path = "public/images/items/GrandSpectrum2_red.webp" },
    @{ Url = "https://cdn.poedb.tw/image/item/popup/divination-card.webp"; Path = "public/images/ui/divination-card.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderCurrencyLeft.webp"; Path = "public/images/ui/ItemsHeaderCurrencyLeft.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderCurrencyRight.webp"; Path = "public/images/ui/ItemsHeaderCurrencyRight.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderCurrencyMiddle.webp"; Path = "public/images/ui/ItemsHeaderCurrencyMiddle.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderUniqueLeft.webp"; Path = "public/images/ui/ItemsHeaderUniqueLeft.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderUniqueRight.webp"; Path = "public/images/ui/ItemsHeaderUniqueRight.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DArt/UIImages/InGame/ItemsHeaderUniqueMiddle.webp"; Path = "public/images/ui/ItemsHeaderUniqueMiddle.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/basicstr.webp"; Path = "public/images/items/basicstr.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/basicdex.webp"; Path = "public/images/items/basicdex.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/basicint.webp"; Path = "public/images/items/basicint.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/MurderousEye.webp"; Path = "public/images/items/MurderousEye.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/SearchingEye.webp"; Path = "public/images/items/SearchingEye.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/RivetedEye.webp"; Path = "public/images/items/RivetedEye.webp" },
    @{ Url = "https://cdn.poedb.tw/image/Art/2DItems/Jewels/GhastlyEye.webp"; Path = "public/images/items/GhastlyEye.webp" }
)

$failed = @()

foreach ($img in $images) {
    $dir = Split-Path -Parent $img.Path
    if (!(Test-Path -Path $dir)) {
        New-Item -ItemType Directory -Path $dir -Force | Out-Null
    }

    if (!(Test-Path -Path $img.Path)) {
        Write-Host "Downloading $($img.Url) to $($img.Path)..."
        try {
            Invoke-WebRequest -Uri $img.Url -OutFile $img.Path -UserAgent "Mozilla/5.0"
        }
        catch {
            Write-Error "Failed to download $($img.Url): $_"
            $failed += @{ Url = $img.Url; Path = $img.Path; Error = $_ }
        }
    } else {
        Write-Host "Skipping $($img.Path) (already exists)"
    }
}

if ($failed.Count -gt 0) {
    Write-Host "`n--- Failed Downloads ---"
    foreach ($f in $failed) {
        Write-Host "URL: $($f.Url)"
        Write-Host "Path: $($f.Path)"
        Write-Host "Error: $($f.Error)"
        Write-Host "---"
    }
} else {
    Write-Host "`nAll downloads completed successfully!"
}
